<div class="container mt-5">
  <%= search_form_for(@q, url: searches_path) do |f| %>
    <%= f.label :evaluation, "星評価(以上)" %>
    <%= f.number_field :branch_evaluation_gteq %><br>
    <%= f.label :area, "　　　　地域" %>
    <%= f.text_field :branch_area_cont %><br>
  <%= f.submit %>
  <% end %>

  <h4>イベント一覧</h4>
  <table class="table">
   
    <thead class="thead-dark">
      <tr>
        <th scope="col">日時</th>
        <th scope="col">支部地域</th>
        <th scope="col">　支部名</th>
        <th scope="col">支部評価</th>
        <th scope="col"></th>
        <th scope="col"></th>
        <th scope="col"></th>
        <th scope="col">最寄駅</th>
        <th scope="col">会場</th>
      </tr>
    </thead>

    <tbody>
      <% @events.each do |e| %>
        <tr>
          <td><%= l e.date %></td>
          <td><%= e.branch.area %></td>
          <td><%= e.branch.name %></td>
          <td><div class="star" data-score="<%= e.branch.evaluation %>"></div></td>
          <% e.event_staffs.each do |e| %>
            <% if e.operations.予約済・募集中 %>
              <td>[予約済]<%= e.family_name %><%= e.given_name %></td>
            <% elsif e.operations.運営者 %>
              <td>[主]<%= e.family_name %><%= e.given_name %></td>
            <% elsif e.operations.幹事 %>
              <td>[幹]<%= e.family_name %><%= e.given_name %></td>
            <% elsif e.operations.事務局長 %>
              <td>[事]<%= e.family_name %><%= e.given_name %></td>
            <% end %>
          <%end%>
          <td><%= e.station1 %></td>
          <td><%= e.prefecture_name %><%= e.address %></td>
        </tr>
      <% end %>
    </tbody>

  </table>

  <!--ページネーション-->
  <%= paginate @events %>

  <!-- 星評価js -->
  <script>
    $('.star').raty({
      readOnly: true,
      score: function() {
        return $(this).attr('data-score');
      },
      path: '/assets/'
    });
  </script>
  <!-- ここまで -->

</div>